{"ast":null,"code":"var _jsxFileName = \"/home/meina/Documents/Share-It/src/post/UploadImage.js\";\nimport React, { useState } from 'react';\nimport { Button } from '@material-ui/core';\nimport { storage, db } from '../Firebase';\nimport firebase from \"firebase\";\nimport './UploadImage.css';\n\nfunction UploadImage(username) {\n  // destructuring \n  const [caption, setCaption] = useState('');\n  const [url, setUrl] = useState(\"\");\n  const [progress, setProgress] = useState(0);\n  const [image, setImage] = useState(null);\n\n  const handleChange = e => {\n    // e: event, handleChange: a function\n    if (e.target.files[0]) {\n      // get the first file you have selected and \n      setImage(e.target.files[0]); // set the image in state to it.\n    }\n  };\n\n  const handleUpload = () => {\n    const uploadTask = storage.ref(`images/${image.name}`).put(image); // access the storage in firebase and get a reference of the folder-images .name is the name of the file to uploaded and will be stored in the folder images in firebase. .put does put the image in the folder. basically uploading it to firebase storage\n\n    uploadTask.on(\"state_changed\", snapshot => {\n      //progress function\n      const progress = Math.round(snapshot.bytesTransfered / snapshot.totalBytes * 100);\n      setProgress(progress);\n    }, error => {\n      // error function\n      console.log(error);\n      alert(error.message);\n    }, () => {\n      // complete function\n      storage.ref(\"images\").child(image.name).getDownloadURL() // get the Download link of the file from firebase\n      .then(url => {\n        // post the image inside the database\n        db.collection(\"posts\").add({\n          timestamp: firebase.firestore.FieldValue.serverTimestamp(),\n          // regardless where you are in the world, the firebase timestamp is consistent.\n          caption: caption,\n          imageUrl: url,\n          // take the download link and put it into the firebase database.\n          username: username\n        });\n        setProgress(0);\n        setCaption(\"\");\n        setImage(null);\n      });\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"upload-image\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    className: \"upload-image--link\",\n    type: \"file\",\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"input\", {\n    className: \"upload-image--caption\",\n    type: \"text\",\n    placeholder: \"Caption:\",\n    onChange: event => setCaption(event.target.value),\n    value: caption,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(Button, {\n    style: {\n      fontSize: \"15px\",\n      color: \"#314455\",\n      marginBottom: \"20px\",\n      padding: \"10px 20px\"\n    },\n    onClick: handleUpload,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 13\n    }\n  }, \"Upload \\u21A5\"));\n}\n\nexport default UploadImage;","map":{"version":3,"sources":["/home/meina/Documents/Share-It/src/post/UploadImage.js"],"names":["React","useState","Button","storage","db","firebase","UploadImage","username","caption","setCaption","url","setUrl","progress","setProgress","image","setImage","handleChange","e","target","files","handleUpload","uploadTask","ref","name","put","on","snapshot","Math","round","bytesTransfered","totalBytes","error","console","log","alert","message","child","getDownloadURL","then","collection","add","timestamp","firestore","FieldValue","serverTimestamp","imageUrl","event","value","fontSize","color","marginBottom","padding"],"mappings":"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","sourcesContent":["import React, { useState } from 'react'\nimport { Button } from '@material-ui/core';\nimport { storage, db } from '../Firebase';\nimport firebase from \"firebase\";\nimport './UploadImage.css';\n\nfunction UploadImage(username) { // destructuring \n    const [caption, setCaption] = useState('');\n    const [url, setUrl] = useState(\"\");\n    const [progress, setProgress] = useState(0);\n    const [image, setImage] = useState(null);\n\n    const handleChange = (e) => { // e: event, handleChange: a function\n        if (e.target.files[0]) { // get the first file you have selected and \n            setImage(e.target.files[0]); // set the image in state to it.\n        }\n    }\n\n    const handleUpload = () => {\n        const uploadTask = storage.ref(`images/${image.name}`).put(image); // access the storage in firebase and get a reference of the folder-images .name is the name of the file to uploaded and will be stored in the folder images in firebase. .put does put the image in the folder. basically uploading it to firebase storage\n        uploadTask.on(\n            \"state_changed\",\n            \n            (snapshot) => {\n                //progress function\n                const progress = Math.round(\n                    (snapshot.bytesTransfered / snapshot.totalBytes) * 100\n                );\n                setProgress(progress);\n            },\n            \n            (error) => {\n                // error function\n                console.log(error);\n                alert(error.message);\n            },\n            () => {\n                // complete function\n                storage\n                .ref(\"images\")\n                .child(image.name)\n                .getDownloadURL() // get the Download link of the file from firebase\n                .then(url => {\n                    // post the image inside the database\n                    db.collection(\"posts\").add({\n                        timestamp:firebase.firestore.FieldValue.serverTimestamp(), // regardless where you are in the world, the firebase timestamp is consistent.\n                        caption: caption,\n                        imageUrl: url, // take the download link and put it into the firebase database.\n                        username: username\n                    });\n\n                    setProgress(0);\n                    setCaption(\"\");\n                    setImage(null);\n                })\n            }\n        )\n\n    }\n\n    return (\n        <div className=\"upload-image\">\n            <input \n                className=\"upload-image--link\"\n                type=\"file\" \n                onChange={handleChange} \n            />\n            <br />\n\n            {/*<progress value={progress} max=\"100\" /> */}\n            <input \n                className=\"upload-image--caption\"\n                type=\"text\" \n                placeholder=\"Caption:\" \n                onChange={event => setCaption(event.target.value)} \n                value={caption} \n            />\n            <br />\n            \n            <Button \n                style={{\n                    fontSize: \"15px\",\n                    color: \"#314455\",\n                    marginBottom: \"20px\",\n                    padding:\"10px 20px\"\n                }}\n                onClick={handleUpload}\n            >\n                Upload ↥ \n            </Button>\n        </div>\n    )\n}\n\nexport default UploadImage\n"]},"metadata":{},"sourceType":"module"}